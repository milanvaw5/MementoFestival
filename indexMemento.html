<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="./css/reset.css">
    <link rel="stylesheet" href="./css/style.css">
    <link rel="stylesheet" href="https://use.typekit.net/wna0uhq.css">
     <!-- Load TensorFlow.js -->
 <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs/dist/tf.min.js"> </script>
 <!-- Load Posenet -->
 <script src="https://unpkg.com/@tensorflow-models/posenet"></script>
    <title>De letterdoos</title>
</head>
  <body>
    <h1 class="titel">De Letterdoos - Memento Festival</h1>


    <section class="onepager__section">
      <h2 class="section__title">Word Game with input possibilities</h2>

      <article class="section__article">
        <h3 clas="article__title">Information Website</h3>

        <div class="wordGame topblock">
          <div class="informationblock video__auteur">
            <p>LIVE</p>
            <p>op het festival</p>
          </div>
          <button class="button smallbutton"><a class="link buttonlink" href="">Say Hi!</a></button>
        </div>

        <div id="bottomblock" class="wordGame bottomblock">
        <!-- hier komt de wordgame -->
        </div>
        <div class="container">
          <canvas id="c"></canvas>
          <video id="otherCamera" playsinline autoplay></video>
        </div>
      </article>

    </section>

      <script src="js/vendors/phaser.min.js"></script>
      <script src="js/vendors/matter.js"></script>
      <script src="/socket.io/socket.io.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/simple-peer/9.7.2/simplepeer.min.js" integrity="sha512-RZlErEuUwWv3EhGNhvni9vinu0QPwNU0OyWAlhTeezEToTZu/C+/Mn7ItRFmpcf8MTK0J2kRalSfzrpQqF7wJQ==" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.5.0/gsap.min.js" integrity="sha512-JO6JyFPJupQKZf7icgZkHwuq/rAQxH7COqvEd4WdK52AtHPedwHog05T69pIelI69jVN/zZbW6TuHfH2mS8j/Q==" crossorigin="anonymous"></script>
      <script type="module" src="js/script.js"></script>
      <script type="module" src="js/camera.js"></script>
      <script type="module" src="js/socket.js"></script>
      <script type="module">

        const $otherCamera = document.getElementById('otherCamera');

        let socket;
        let peer;

        const servers = {
          iceServers: [{
            urls: `stun:stun.l.google.com:19302`
          }]
        };

        const init = async () => {
          initSocket();
          $otherCamera.addEventListener('click', () => {
            $otherCamera.play();
          });
        };

        const initSocket = () => {
          socket = io.connect(`/`);
          socket.on(`connect`, () => {
            console.log(socket.id);
          });

          socket.on('signal', async (myId, signal, peerId) => {
            console.log(`Received signal from ${peerId}`);
            console.log(signal);
            if (signal.type === 'offer') {
              answerPeerOffer(myId, signal, peerId);
            }
            peer.signal(signal);
          });
        };

        const answerPeerOffer = async (myId, offer, peerId) => {
          peer = new SimplePeer();
          peer.on('signal', data => {
            socket.emit('signal', peerId, data);
          });
          peer.on('stream', stream => {
            $otherCamera.srcObject = stream;
          });
        };

        init();

      </script>
  </body>
</html>
